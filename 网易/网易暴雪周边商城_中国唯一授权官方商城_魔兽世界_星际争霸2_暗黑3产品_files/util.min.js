function assert(condition,err_msg){if(!condition){alert(err_msg);throw new Error(err_msg);}}
var yuan2fen=function(v){return Math.round(parseFloat(v)*100);};var fen2yuan=function(v){if(!/\d+/.test(v)){alert('单位转换错误，v='+v);}
var temp_v=v.toString();var str_len=temp_v.length;if(str_len<3){for(i=0;i<3-str_len;i++){temp_v="0"+temp_v;}}
return temp_v.replace(/^(-?\d+)(\d{2})\d*$/,"$1.$2");};var fen2point=function(v,method){method=method||'ceil';if(method=='ceil'){return parseInt(Math.ceil(parseFloat(v,10)/10),10);}else{return parseInt(Math.floor(parseFloat(v,10)/10),10);}};var point2fen=function(v){var fen=parseInt(v,10)*10;return fen;};function max(a,b){return a>b?a:b;}
function min(a,b){return a<b?a:b;}
function checkInt(v){return/^[1-9]\d*$/.test(v);}
var __g_end_min
var __g_end_max;var __g_delta={Y:2};var __g_date_type="datetime";var __g_strpfmt=null;var __g_end_label=null;function syn_query_time(dpicker_obj){if(__g_date_type=="datetime"){var strpfmt=__g_strpfmt?__g_strpfmt:"%Y-%m-%d %H:%M:%S";var strffmt="%F %X";var end_err_le_fmt="%F 23:59:59";var end_err_ge_fmt="%F %X";}
else if(__g_date_type=="date"){var strpfmt=__g_strpfmt?__g_strpfmt:"%Y-%m-%d";var strffmt=end_err_le_fmt=end_err_ge_fmt=__g_strpfmt?__g_strpfmt:"%F";}
if(dpicker_obj){if(!__g_end_label)
var end_label=dpicker_obj.el.name.replace("begin","end");else if(typeof(__g_end_label)=="object")
var end_label=__g_end_label[dpicker_obj.el.name];else if(typeof(__g_end_label)=="string")
var end_label=__g_end_label;__g_end_min=Date.strptime(dpicker_obj.el.value,strpfmt);$end_picker=$("input[alt='dpicker'][name='"+end_label+"']");__g_end_max=__g_end_min.addDelta(__g_delta);if(!$end_picker.attr("value")){__g_end_min=__g_end_min.strftime(strffmt);__g_end_max=__g_end_max.strftime(strffmt);return;}
var end=Date.strptime($end_picker.attr("value"),strpfmt);if(end.le(__g_end_min))
$end_picker.attr("value",__g_end_min.strftime(end_err_le_fmt));else if(end.ge(__g_end_max))
$end_picker.attr("value",__g_end_max.strftime(end_err_ge_fmt));__g_end_min=__g_end_min.strftime(strffmt);__g_end_max=__g_end_max.strftime(strffmt);}
else{var $dp_inputs=$("input[alt='dpicker']");if($dp_inputs.length%2){throw new Error("Find WdatePicker inputs of odd nums.");}
for(i=0;i<$dp_inputs.length;i+=2){__g_end_min=Date.strptime($dp_inputs[i].getAttribute("value"),strpfmt);__g_end_max=__g_end_min.addDelta(__g_delta);var end=Date.strptime($dp_inputs[i+1].getAttribute("value"),strpfmt);if(end.le(__g_end_min)){$dp_inputs[i+1].value=__g_end_min.strftime(end_err_le_fmt);}
else if(end.ge(__g_end_max)){$dp_inputs[i+1].value=__g_end_max.strftime(end_err_ge_fmt);}
__g_end_min=__g_end_min.strftime(strffmt);__g_end_max=__g_end_max.strftime(strffmt);}}}
$.extend({buyer_ajax:function(url,params,callback_func){$.post(url,params,function(json_data){if(json_data.unlogin){alert('您尚未登录或登录状态已过期。');window.location.reload();return;}
if(json_data.error&&json_data.msg!=""){alert(json_data.msg);return;}
callback_func(json_data);},'json');},admin_ajax:function(url,params,callback_func){$.post(url,params,function(json_data){if(json_data.unlogin){Popup.alertMsg('您尚未登录或登录状态已过期。');window.location.reload();return;}
if(json_data.error){Popup.alertMsg(json_data.msg);return;}
callback_func(json_data);},'json');},has_key:function(dict,key){var has=false;$.each(dict,function(k,v){if(k==key){has=true;return false;}});return has;},search:function(list,item){var index;if(typeof(item)=='string'){index=list.indexOf(item);}else{index=$(list).index(item);}
return index!=-1?list[index]:null;},is_unique:function(list){for(var i=0;i<list.length-1;i++){for(var j=i+1;j<list.length;j++){if(list[i]==list[j]){return false;}}}
return true;},has_chinese:function(v){var reg=new RegExp('[\u4e00-\u9fa5]');return reg.exec(v)!=null?true:false;},sum:function(l){var s=0;$.each(l,function(i,n){s+=n;});return s;},is_empty_dict:function(d){var ret=true;$.each(d,function(){ret=false;return false;});return ret}});function str_len(str){return str.replace(/[\u4e00-\u9fa5]/g,'xx').length;}
function add_load_event(func){var old_onload=window.onload;if(typeof window.onload!="function"){window.onload=func;}
else{window.onload=function(){old_onload();func();}}}
function back(uri)
{if(uri){window.location=uri;}else{window.history.go(-1);}}
function include_css(url,callback){var head=document.getElementsByTagName('head')[0];var style=document.createElement('link');style.href=url;style.type='text/css';style.rel='stylesheet';style.media='screen';var done=false;style.onload=style.onreadystatechange=function(){if(!done&&(!this.readyState||this.readyState=='loaded'||this.readyState=='complete')){if(typeof callback==='function'){callback();done=true;}}}
head.appendChild(style);}
var loading_window=function(for_seller){var img='/images/loading.gif';var loading_msg='正在提交中，请等待！<br />等待期间，请勿关闭页面。';var loading_html=for_seller?'<br /><br /><img src="'+img+'" />&nbsp;&nbsp;'+loading_msg+'<br /><br /><br />':'<img src="'+img+'" />&nbsp;&nbsp;'+loading_msg+'<br /><br />';var overtime_msg=for_seller?'<span class="cYellow" style="text-align:center;display:block;">系统超时，请重新提交！&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>':'请求超时，请重新提交！';this.show=function(){Popup.loading(loading_html);};this.overtime=function(){return for_seller?Popup.alertMsg('错误提示&nbsp;',overtime_msg):Popup.alertMsg(overtime_msg);};};function ajax_submit(opt){var lw=new loading_window(opt.for_seller);$.ajax({"url":opt.url,"data":opt.data,"type":"POST","dataType":"json","timeout":opt.time?opt.time:10*60*1000,"beforeSend":function(xmlhttp_obj){lw.show();},"error":function(error_obj,error_str){lw.overtime();},"success":function(json_data){opt.success(json_data);}});}
$.fn.extend({enable:function(){return this.each(function(){this.disabled=false;});},disable:function(){return this.each(function(){this.disabled=true;});}});function cookie_check_logined(){var s_info=$.cookie("S_INFO");var p_info=$.cookie("P_INFO");var now=new Date();if(s_info!=null&&s_info!=""&&p_info!=null&&p_info!=""&&(now.getTime()/1000-s_info.split('|')[0])/3600<1){return p_info.split('|')[0];}
return'';}
function login_err_code(url){var res=/^.*errorType=(\d+).*/.exec(url);return(res?res[1]:null)}
function login_err_msg(code){var msg_map={'412':'尝试次数过多,请稍后再试','414':'尝试次数过多,请稍后再试','415':'尝试次数过多,请稍后再试','416':'尝试次数过多,请稍后再试','417':'尝试次数过多,请稍后再试','418':'尝试次数过多,请稍后再试','419':'尝试次数过多,请稍后再试','420':'用户名或密码错误','422':'帐号被锁定,请先解锁','424':'靓号服务到期,请续费','460':'用户名或密码错误','500':'系统繁忙,请稍后再试','503':'系统维护中,请稍后再试'};var msg=msg_map[code];if(!msg){msg='未知错误'+code;}
return msg;}
function get_file_path(obj){if(obj){if(window.navigator.userAgent.indexOf("MSIE")>=1){obj.select();obj.blur();return document.selection.createRange().text;}
return obj.value;}}
function static_url(url_base,param_dict){var url=url_base;if(!/\/$/.test(url_base)){url+='/';}
var params='';for(var p in param_dict){params+=([p,param_dict[p]].join('___')+'/');}
url+=params;return url;}
function opends($cover,$content){$cover.css({"height":$(document).height()}).show();$content.show().css({"top":($(window).height()-$content.height())/2+$(window).scrollTop(),"left":($(window).width()-$content.outerWidth())/2+$(window).scrollLeft()});}
function closeds($cover,$content){$content.hide();$cover.hide();}